<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Legal Helper - Chat</title>
  <link rel="stylesheet" href="../../css/user/chat.css" />
  <style>
    .fade-in {
      animation: fadeInPage 0.8s ease-in-out;
    }
    @keyframes fadeInPage {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="fade-in">
  <div class="container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">
          <h2>Legal Helper</h2>
          <span id="newChatBtn" class="settings">üí¨</span>
        </div>
        <input type="text" class="search-bar" placeholder="T√¨m ki·∫øm cu·ªôc tr√≤ chuy·ªán..." />
      </div>
      <div class="chat-history">
        <div class="chat-session active">
          <div class="chat-title">Ly h√¥n</div>
          <div class="chat-preview">"T√¥i mu·ªën h·ªèi v·ªÅ th·ªß t·ª•c ly h√¥n..."</div>
        </div>
        <div class="chat-session">
          <div class="chat-title">H·ª£p ƒë·ªìng nh√†</div>
          <div class="chat-preview">"C√≥ c·∫ßn c√¥ng ch·ª©ng khi thu√™ nh√† kh√¥ng?"</div>
        </div>
      </div>
      <div class="sidebar-footer">
        <a href="../user/feedback.html" class="btn btn-outline">Ph·∫£n h·ªìi</a>
        <a href="../user/subscription.html" class="btn btn-primary">G√≥i d·ªãch v·ª•</a>
      </div>
    </aside>

    <!-- Chat panel -->
    <section class="chat-panel">
      <div class="chat-header">
        <div class="header-left">
          <a href="user_information.html">
            <img src="../../assets/legal_img.jpg" alt="Avatar" class="bot-avatar" />
          </a>
          <h3>Chat v·ªõi Legal Helper</h3>
        </div>
      </div>
      <div class="chat-window" id="chatWindow">
        <div class="message bot">
          <div>Xin ch√†o! T√¥i l√† Legal Helper. B·∫°n c·∫ßn h·ªó tr·ª£ g√¨?</div>
          <div class="message-time">09:00</div>
        </div>
      </div>
      <div class="chat-input-area">
        <textarea id="chatInput" class="chat-input" placeholder="Nh·∫≠p c√¢u h·ªèi..." rows="1"></textarea>
        <button id="sendBtn" class="send-btn">G·ª≠i</button>
      </div>
    </section>
  </div>

  <script>
    const chatWindow = document.getElementById('chatWindow');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');
    const newChatBtn = document.getElementById('newChatBtn');

    sendBtn.addEventListener('click', () => submitMessage());
    chatInput.addEventListener('input', () => {
      chatInput.style.height = 'auto';
      chatInput.style.height = chatInput.scrollHeight + 'px';
    });
    chatInput.addEventListener('keypress', e => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        submitMessage();
      }
    });

    function submitMessage() {
      const text = chatInput.value.trim();
      if (!text) return;

      const userMsg = document.createElement('div');
      userMsg.className = 'message user animated';
      userMsg.innerHTML = `<div>${text}</div><div class="message-time">${new Date().toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' })}</div>`;
      chatWindow.appendChild(userMsg);

      const botMsg = document.createElement('div');
      botMsg.className = 'message bot animated';
      botMsg.innerHTML = `<div>ƒêang x·ª≠ l√Ω c√¢u h·ªèi...</div>`;
      chatWindow.appendChild(botMsg);

      chatInput.value = '';
      chatInput.style.height = 'auto';
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    newChatBtn.addEventListener('click', () => {
      chatWindow.innerHTML = '';
      const welcome = document.createElement('div');
      welcome.className = 'message bot animated';
      welcome.innerHTML = `
        <div>Xin ch√†o! T√¥i l√† Legal Helper. B·∫°n c·∫ßn h·ªó tr·ª£ g√¨?</div>
        <div class="message-time">${new Date().toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' })}</div>
      `;
      chatWindow.appendChild(welcome);
      chatInput.value = '';
      chatInput.style.height = 'auto';
      chatInput.focus();
    });
  </script>
</body>
</html>
